Q1:蓝瓶生产的时候需要的内燃机，需要铁齿轮，问：这个铁齿轮，是从铁齿轮模块拿？还是内嵌在内燃机模块中？前者是完全分层模块化的设计，后者可能较高耦合性。（该问题不局限于蓝瓶和铁齿轮，可以是任意终端产物C和任意中间产物B，例如B也可以是钢材。）
Q2:内燃机依赖铁齿轮，和软件依赖的导入其他类(import)有什么不同。
Q3:蓝图和规划的功能出现之后，玩家的游戏模式和设计思路发生了什么改变。
Q4:在空间布局上，紫瓶的设计可以如何优化，提高自动化程度。提示：使路径最短。
 
 
Q1&Q2
1） 分层模块化设计的不足与软硬件设计的不同的关系
任何产品都进行模块化设计，以便扩展，然后进行调用，似乎是一个很不错的方法。然而后期的工厂却没有按这个设计。因为这款游戏的规则和程序设计又不太一样。这是我从你的蓝瓶设计里想到的一件事。
看蓝瓶生产线需要调用内燃机，内燃机调用钢材，管道以及铁齿轮。如果是写程序，就是import 内燃机。然后在内燃机的模块又import 管道和铁齿轮以及钢材。最后这三个材料import铁板。写程序这样写成接口清晰易懂，耦合性低，可扩展性强。
所以，考虑铁齿轮这个制造机，我的最初想法是应该分开。但仔细想想，像你那样把它放进内燃机的框里是比较好的，而不是去铁齿轮模块那里拿。所以我之前的想法有问题。
这是因为这款游戏的规则和程序设计有两个不同。第一个不同是底层配方较为稳定，这点有点像软件和硬件的不同。换句话说蓝瓶如果某天需要调用新的材料，或者铁齿轮的个数改了，那么按照低耦合的设计，就是把铁齿轮分开，修改铁齿轮的产量即可，这块蓝瓶模块不需要任何改动。但是就像刻一块板子一样，涉及到硬件的规律较为固定；在配方不变的情况下，可以放心地进行提前计算，使得效率最高。这里比之前的瓶颈理论要更进一步，就是提前去计算所有东西的比例，让所有东西都恰好工作，完全算好，最后完全按照计算的来行事。制作蓝图。精确到每分钟多少个铜矿输入都计算好。这样一来不会出现、也不应该出现任何瓶颈，不应该出现错误的D:B:C!=1:4:1，而是计算后的绝对正确，这里的正确指的是到达理论目标。（当然输入需要达到饱和）。精确性（配方的稳定性或者说硬件规律的不变性）是保证耦合度可以变高的原因之一。假如某天铁齿轮这个函数变了，如果是软件设计，我是蓝瓶，对方负责铁齿轮，对方修改了配方没法通知你，所以铁齿轮应该import。低耦合get。但是实际上在这个玩法体系里，铁齿轮的配方不变、简洁。所以我来做铁齿轮也完全OK。
由于第一点的存在，假设，可以这么计算：只需要一个铁齿轮组装机，就能覆盖5个内燃机（从而蓝瓶）组装机的需求，甚至当后续扩展到20个蓝瓶组装机，也不需要提高铁齿轮组装机的个数（体现为当前规划中显示，需要0.25个铁齿轮组装机）；如果是这样，那么这1个组装机，对局部模块的侵入性和破坏性就很小，它很稳定。不需要考虑，扩展蓝瓶产量是不是会修改结构。即使不变，也支持了限度范围内的扩展性（可以扩展到20个组装机增加4倍产量）。
举例：铜线每0.5s可生产2个，每秒4个。而每生产一个红板（集成电路）消耗4个铜线需要6s。所以1个铜线的组装机就能够支持6个集成电路的组装机。如果我们做这样的规划，即先定目标然后再画蓝图，每分钟需要2000个集成电路，这个时候我们计算得到需要20个组装机生产，此时我们可以（根据规划器）计算出铜线组装机是3.2个。这时候我们考虑的就是：是做一个铜线的单独生产，还是把这3.2个铜线组装机嵌入到20个集成电路的生产线中？
这个时候，主要问题变为了从铁齿轮/管道模块那里拉两根线过来，还是从铁板那里拉一根线过来，局部组装铁齿轮和管道。也就涉及到了第二个不同：需要考虑走线和空间规划。蓝瓶，既调用了铁齿轮又调用了管道。这两个都调用了铁板。如果是程序设计，那么选择import A和import B即可，import两个还是一个无非就是在头文件那里多了一行，凭空抓过来，就好像魔法，对外部的复杂性的改动，不是我要关心的话题。即使是考虑依赖树，也不会去思考空间问题，而只是需要保证拓扑排序避免循环依赖即可。但是硬件设计里调用是有代价的。拉两根线和拉一根线，差别非常大，而且还是2D构建，刻板子的走线问题，线路交叉繁复，更别说还对流量输入有要求。所以能从主干道拉一根，也许比两根要好。宁可局部复杂，也不要让主干道复杂。就这点意义上说，钢材是不是也可以考虑局部地制造？但钢材需要过多电炉，可能会出现扩展麻烦。所以关键的放到主干道的资源，除了它的出度要足够高之外，另外还有一点是它组装起来要足够慢，本身就非常臃肿，不得不从主干道去获取。例如铁板，红板子和绿板子。内燃机甚至也可以考虑在内。而铁齿轮和管道反而因为组装起来容易所以可以局部构建，内嵌到模块内部。设想，铁板如果同样是一个很重要的资源，但是，可以通过一个新的制造机器：光合作用机，进行光合作用获取，每分钟获取速度10000，这样一来，所有的模块都可以在某个角落内嵌一个光合作用机，而不是即使在第五层，也跑到前面去专门拿铁板。这样一来主干道就不需要设置铁板。但是如果这个光合作用机每分钟只能生成1个呢？这时候，就只能乖乖往回拿。同理，如果铁齿轮的生产速率并不是游戏中这么快，那么就应该import铁齿轮，而不是内嵌。不过换个思路考虑，如果使用蓝图和规划，把一切都提前定好了，那么即使是例如8个A需要10个B这种麻烦的设计，也可以打包成为一个模块。这有点像硬件优化，针对专门的硬件可以损失通用性，做专门的优化，让效率更高。如果这样思考，所有的模块，理论上最终都可以设计成为仅依赖于源头设计的。也就是输入仅仅只有煤铁铜，然后输出每分钟多少个金瓶，但随着配方复杂度的提高设计的难度指数级上涨。不过，这个游戏和硬件设计还有不同的一点是不用考虑响应时间。B离A太远，开机之后传输需要时间，但是一旦A送到了，就会不停生产B，前面的响应时间不是关注目标。现实中的设计可能会考虑A和B的沟通速度，涉及到回调，或者开机时间等等。或者两个传送带之间的干扰作用等等。
Q3
2）蓝图作为一种作弊手段，或者不同的游戏模式：面向结果编程
当游戏中有时间因子的时候，隐藏着一个问题，就是思考时间也是时间的一种，然而设计蓝图的时间却是在“游戏之外”的。可想而知这样的蓝图不仅在质量上比现场思考的要来得高（毕竟经过了精密计算，而且不会被一些突发事件打断思路），而且实际上只花了1分钟的游戏时间。这样的设计只有优点没有缺点。我认为官方倾向于把这点当做一个游戏的feature而不是定义为作弊手段，论据是对蓝图功能的支持，代码输入，机器人等。不管怎样，它都会根本地修改游戏的表现形式。
从这点看，模块化的开发方式具有短平快的优点，类似于敏捷开发，快速上线可供使用。换句话说，如果硬性规定，思考蓝图的时间也要计算在时间范围之内，那么由于蓝图的思考和计算时间过长，完全分层模块化开发的方式就是一个非常优异的、迅速上线的形式，因为这种方式需要很少的计算。而且当之后会发现某插件也需要铁齿轮，那么此时铁齿轮直接扩展就比重新拉一条铁齿轮生产来得方便迅捷。
而另一方面，当蓝图功能以及规划计算器出现之后，游戏的表现形式（应该说是游玩形式）发生了巨大的变化。问题已经并不出现在：去发现系统的瓶颈在哪。换句话说，如果有了蓝图功能，一个系统跑起来之后，假如我们不断地发现：缺铜板。或者缺铜线。或者缺电。或者缺电路板。或者加了一部分的产能之后发现它的某个依赖产能不足了，然后一路往前追溯。那么，这个系统将被定义为一个失败的系统，这个设计可以被定义为一个有缺陷的设计。因为它需要人去不断地耗费精力去关注这些本来可以算好的事情。这是一个画靶子再射的游戏：我先规定了需要黄瓶20个每min（必要时可以加到50）。根据规划，可以计算出，…，要求25个铜矿的采矿机。在蓝图的设计的时候已经考虑了这点，所以会要求25个采矿机，所以在蓝图拍下的瞬间就会放下额外的25个采矿机，以及多少个电炉，每个电炉上面的插件具体需要多少个，并且通过怎样的物流手段，去要求这些铜板以怎样的速率（例如每min 90个）到达黄瓶的输入入口。当我加产能的时候，我需要计算出铜板的输入速度也需要加快。如果这一切都是规划好的：那么，在任意时刻，铜板不足的问题就是不应该出现的问题。就好比一个手机已经卖出去了，这时候突然发现不能拍照了，要求返修，这是不正常的。这种精确性是建立在蓝图功能的基础上的，如果没有蓝图和规划器，这样的debug（作为第一次通关的进程）就是可以接受的。
顺便还有额外的一点，就是：如果计算结果表明（组装机2）每分钟2个铜线是足够的，当前也可以做到这一点，那么，我认为，每分钟6个铜线（例如使用好的传送带，使用插件，使用组装机3）就是没有必要的，不仅它会造成资源的浪费（这个问题并不是一个主要问题），同时它对后续可扩展性的支持有限，并且从设计的角度来说，我觉得这是一种有点奇怪的设计思路，就好像我定义了一个枚举类，然后枚举上一大堆常量，最后却只用到了其中的2个。如果其他的常量，在后续可能用到，那么可以用注释的方法补充，需要了再去除注释。Java开发里，定义一个不使用的变量，编译器会标黄。Go语言里，unused会直接在编译期报错。我认为这是一个论据。
 
Q4
 
3）提高自动化程度，整体的空间布局：以紫瓶生产为例
附注：紫瓶的生产
紫瓶的生产如果想做到更优化的自动生产，我觉得可以做这种考虑。

紫瓶现在是这么生产的。从左往右运了石矿，在原地和钢材铁板进行作用。然后从左往右运了集成电路。然后从右往左运回铁轨、电炉。在左边生产产能插件1。最后在左边生产紫瓶。
 
由于紫瓶最后输出在左边。所以，就算中间产物（电炉、墙壁）拉到右边生产（2条往右的线路，石砖，集成电路），最后也需要拉回左边（一条往左的线路，电炉，墙壁）。一来一回，增加了线路。

具体到紫瓶，目前总共有4条线。那么：为什么不直接把所有的东西都放在左边生产呢。如此，从右往左拉铁板和钢材即可（2条线）

 
更重要的是这种方法符合统一的从右往左、从底层往高层的空间布局。铁板线路和钢材线路还可以复用（例如铁板还用于生产绿板，铁板还可用于生产电动机，钢材还用于生产黄瓶。）。从而可以进一步实现自动化，减少人工搬运作业。
 
 
4）总结
写的比较乱。总结起来有这么几点。
第一是蓝图作为作弊功能，如果承认它的正当性，那么建议采用。那么就是先画靶子再设计。先估算需要每分钟20个黄瓶，然后根据这个来拍一套蓝图。组装简单的中间产品考虑并入蓝图，组装困难需求量大生产较慢的产品考虑放在外面隔层生产并且拉过来。文档设计：需要的输入和输入的最少流速也计算好。如果这个设计图可以扩展（比如预先使用组装机2，后续通过改组装机3的形式）到每分钟50个之类的，那更好。最重要的是流量是要可实现的，比如每分钟50个黄瓶需要过多的铜矿矿机，目前暂时无法实现；同时如果能够计算出，比如说，需要CPU输入的数量，那么就可以进行预先设计，防止后续的debug流程。（比如跑着跑着发现CPU不足）
那如果可扩展性还是不足怎么办，例如未来可能要扩展到100个，那就到时候再设计一个新的蓝图。或者针对这种情况在蓝图内部考虑水平方向的扩展。
第二是布局尽量统一，考虑从右到左从而更方便地执行自动化。